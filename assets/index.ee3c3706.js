import{d as e,o as t,c as r,a as n,t as a,b as s,u as o,e as l,r as i,f as c,w as u,g as d,F as m,h as p,i as f,j as g,k as v,l as y,m as h,n as b,p as w,q as x,s as k,v as C,x as S,S as E,y as T,z as O}from"./vendor.65b8f118.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const _={class:"fixed opacity-80 text-center bg-purple-800 inset-0 z-50 flex flex-col items-center justify-center text-white"},N=n("h1",{class:"text-2xl mx-16 mb-4"}," Coin list fetch failed. Try reloading this page. ",-1),B={class:"text-base block"};var P=e({props:{message:{type:String,required:!0}},setup:e=>(s,o)=>(t(),r("div",_,[N,n("pre",B,a(e.message),1)]))});const L={"aria-hidden":"true"},M=["xlink:href"];var A=e({props:{prefix:{type:String,default:"icon"},name:{type:String,required:!0}},setup(e){const a=e,l=s((()=>`#${a.prefix}-${a.name}`));return(e,a)=>(t(),r("svg",L,[n("use",{"xlink:href":o(l),fill:"currentColor"},null,8,M)]))}});const I={},U={class:"fixed bg-purple-800 bg-opacity-75 inset-0 z-50 flex items-center justify-center"};I.render=function(e,n){const a=A;return t(),r("div",U,[l(a,{class:"animate-spin -ml-1 mr-3 h-12 w-12 text-white",name:"loader"})])};const j=["value"];var D=e({props:{modelValue:{type:String,required:!1}},emits:["update:modelValue"],setup(e,{emit:n}){const a=e=>{n("update:modelValue",e.target.value)};return(n,s)=>(t(),r("input",{class:"block relative shadow-md w-60 pr-10 p-2 border-gray-300 text-gray-900 focus:outline-none focus:ring-gray-500 focus:border-gray-500 sm:text-sm rounded-md",value:e.modelValue,onInput:a},null,40,j))}});const V={},$={type:"button",class:"inline-flex items-center py-2 px-4 border border-transparent shadow-sm text-sm leading-4 font-medium rounded-full text-white bg-gray-600 hover:bg-gray-700 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"};V.render=function(e,n){return t(),r("button",$,[i(e.$slots,"default")])};const G={class:"flex"},z={class:"max-w-xs"},R=n("label",{for:"wallet",class:"block text-sm font-medium text-gray-700"},"Тикер",-1),q={class:"mt-1 relative rounded-md shadow-md"},H={key:0,class:"flex bg-white shadow-md p-1 rounded-md flex-wrap"},F=["onClick"],J={key:1,class:"text-sm text-red-600"},Y=v(" Добавить ");var K=e({props:{getHints:{type:Function,default:null},checkTicker:{type:Function,default:()=>!0}},emits:{addTicker:String},setup(e,{emit:i}){const v=e,y=c("");u(y,(e=>{y.value=e.toUpperCase()}));const h=s((()=>v.getHints&&v.getHints(y.value))),b=s((()=>v.checkTicker&&v.checkTicker(y.value)));function w(){0!==y.value.length&&(i("addTicker",y.value),y.value="")}return(e,s)=>{const i=D,c=A,u=V;return t(),r("section",null,[n("div",G,[n("div",z,[R,n("div",q,[l(i,{id:"wallet",modelValue:y.value,"onUpdate:modelValue":s[0]||(s[0]=e=>y.value=e),type:"text",name:"wallet",placeholder:"Например DOGE",onKeydown:d(w,["enter"])},null,8,["modelValue","onKeydown"])]),y.value.length>0&&o(h)?(t(),r("div",H,[(t(!0),r(m,null,p(o(h),(e=>(t(),r("span",{key:e,class:"inline-flex items-center px-2 m-1 rounded-md text-xs font-medium bg-gray-300 text-gray-800 cursor-pointer",onClick:t=>function(e){y.value=e,w()}(e)},a(e),9,F)))),128))])):f("",!0),o(b)?(t(),r("div",J," Такой тикер уже добавлен ")):f("",!0)])]),l(u,{class:"mt-4",onClick:w},{default:g((()=>[l(c,{class:"-ml-0.5 mr-2 h-6 w-6",name:"add"}),Y])),_:1})])}}});const W=n("label",null,"Поиск",-1);var X=e({emits:["change"],setup(e,{emit:n}){const a=c("");return u(a,(e=>{a.value=e.toUpperCase(),n("change",a.value)})),(e,n)=>{const s=D;return t(),r(m,null,[W,l(s,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=e=>a.value=e),type:"text",class:"mt-2",placeholder:"например DOGE"},null,8,["modelValue"])],64)}}});const Q={class:"space-x-4 my-4"},Z=v(" Назад "),ee=v(" Вперед ");var te=e({props:{showPrev:{type:Boolean,required:!0},showNext:{type:Boolean,required:!0}},emits:["prev","next"],setup:(e,{emit:n})=>(a,s)=>{const o=V;return t(),r("div",Q,[e.showPrev?(t(),y(o,{key:0,onClick:s[0]||(s[0]=e=>n("prev"))},{default:g((()=>[Z])),_:1})):f("",!0),e.showNext?(t(),y(o,{key:1,onClick:s[1]||(s[1]=e=>a.$emit("next"))},{default:g((()=>[ee])),_:1})):f("",!0)])}});const re={class:"px-4 py-5 sm:p-6 text-center"},ne={class:"text-sm font-medium text-gray-500 truncate"},ae={class:"mt-1 text-3xl font-semibold text-gray-900"},se=n("div",{class:"w-full border-t border-gray-200"},null,-1),oe=v(" Удалить ");var le=e({props:{selected:{type:Boolean,required:!1,default:!1},error:{type:Boolean,required:!1,default:!1},ticker:{type:null,required:!0}},emits:["delete"],setup(e){const i=e,c=s((()=>0===i.ticker.price?"-":i.ticker.price<1?i.ticker.price.toPrecision(3):i.ticker.price.toFixed(2)));return(s,i)=>{const u=A;return t(),r("div",{class:b(["bg-white overflow-hidden shadow rounded-lg cursor-pointer transition-shadow ring-purple-800",{"ring-4":e.selected,"bg-red-100":e.error}])},[n("div",re,[n("dt",ne,a(e.ticker.name)+" - USD ",1),n("dd",ae,a(o(c)),1)]),se,n("button",{class:"w-full flex items-center justify-center font-medium bg-gray-100 px-4 py-4 sm:px-6 text-md text-gray-500 hover:text-gray-600 hover:bg-gray-200 hover:opacity-50 transition-all focus:outline-none",onClick:i[0]||(i[0]=h((t=>s.$emit("delete",e.ticker)),["stop"]))},[l(u,{class:"h-5 w-5",name:"delete"}),oe])],2)}}});const ie=w("global",{state:()=>({cryptoObject:{},BTCvalue:0}),actions:{async loadCryptoObject(){const e=await x.get("https://min-api.cryptocompare.com/data/all/coinlist?summary=true",{timeout:5e3});return this.cryptoObject=e.data.Data,this.cryptoObject}}});function ce(e){const t=localStorage.getItem(o(e));return c(t?JSON.parse(t):null)}const ue=[{name:"BTC",price:0},{name:"ETH",price:0},{name:"DOGE",price:0},{name:"XPR",price:0},{name:"ADA",price:0},{name:"USDT",price:0},{name:"LINK",price:0},{name:"UNI",price:0},{name:"DOT",price:0}];function de(){const e=(t=function(e){const t=ce(e);return u(c(e),(()=>{t.value=o(ce(e))})),u(t,(t=>{localStorage.setItem(o(e),JSON.stringify(t))}),{deep:!0}),t}("cryptonomicon-list"),r=ue,null===t.value&&(t.value=r),t);var t,r;const{filter:n,filteredItems:a}=function(e,t,r){const n=c(t);return{filteredItems:s((()=>o(e).filter(r))),filter:n}}(e,"",(e=>e.name.includes(n.value.toUpperCase()))),{page:l,paginatedItems:i,hasNextPage:d}=function(e,t,r=0){const n=c(r),a=s((()=>(n.value-r)*o(t))),l=s((()=>a.value+o(t))),i=s((()=>o(e).length>l.value)),d=s((()=>!i.value)),m=s((()=>n.value!==r)),p=s((()=>Math.ceil(o(e).length/o(t)))),f=s((()=>p.value-1)),g=s((()=>o(e).slice(a.value,l.value)));return u(g,(e=>{0==e.length&&n.value>r&&(n.value=f.value)})),{paginatedItems:g,page:n,startIndex:a,endIndex:l,isLastPage:d,isFirstPage:m,hasNextPage:i}}(a,6,1);function m(t){return e.value.find((e=>e.name===t))}return u(n,(()=>{l.value=1})),{tickers:e,filteredTickers:a,filter:n,page:l,hasNextPage:d,tickerExists:function(e){return Boolean(m(e))},paginatedTickers:i,getTicker:m}}let me;const pe=new Map,fe=new WebSocket("wss://streamer.cryptocompare.com/v2?api_key=95bdf7e8c4ef1827e5f4b13d319b2ac9b409aa62feedc30f0f6553924d6ab246"),ge="subscribe",ve="unsubscribe",ye="update",he=new SharedWorker("/worker.js");function be(e,t,r="USD"){const n=pe.get(e)||[];pe.set(e,[...n,t]),xe({action:"SubAdd",subs:[`5~CCCAGG~${e}~${r}`]}),he.port.postMessage({type:"subscribe",fsym:e,tsym:r})}function we(e,t){if(!t&&"BTC"!==e)return xe({action:"SubRemove",subs:[`5~CCCAGG~${e}~USD`]}),xe({action:"SubRemove",subs:[`5~CCCAGG~${e}~BTC`]}),pe.delete(e),he.port.postMessage({type:"unsubscribe",fsym:e,tsym:"USD"}),void he.port.postMessage({type:"unsubscribe",fsym:e,tsym:"BTC"});const r=pe.get(e)||[];pe.set(e,r.filter((e=>e!==t)))}function xe(e){const t=fe.send.bind(fe,JSON.stringify(e));fe.readyState!==WebSocket.OPEN?fe.addEventListener("open",t):t()}he.port.start(),fe.addEventListener("message",(e=>{const t=JSON.parse(e.data);"20"!==t.TYPE?"429"===t.TYPE&&he.port.addEventListener("message",(({data:{data:e,type:r}})=>{if(r===ye){const{fsym:r,price:n,tsym:a}=e;(pe.get(r)||[]).forEach((e=>e({name:r,price:n,tsym:a,error:!1,message:t})))}})):he.port.addEventListener("message",(({data:{type:e,fsym:t,tsym:r}})=>{e!==ge?e===ve&&xe({action:"SubRemove",subs:[`5~CCCAGG~${t}~${r}`]}):xe({action:"SubAdd",subs:[`5~CCCAGG~${t}~${r}`]})}))})),fe.addEventListener("message",(e=>{const t=JSON.parse(e.data),{TYPE:r,MESSAGE:n,INFO:a}=t;if("500"===r&&"INVALID_SUB"===n){const e=t.PARAMETER.split("~")[2],r=function(e){return e.split("~")[3]}(t.PARAMETER);if("USD"===r){const t=pe.get(e)||[];return pe.delete(e),void t.forEach((t=>be(e,(({name:e,error:n,price:a,message:s})=>{t({name:e,error:n,price:me*a,message:s,tsym:r})}),"BTC")))}const n=pe.get(e);return n?void n.forEach((t=>t({name:e,error:!0,message:a,tsym:r,price:NaN}))):void we(e)}if("5"===r){const{FROMSYMBOL:e,PRICE:r,TOSYMBOL:n}=t;if(r){he.port.postMessage({type:"update",data:{fsym:e,price:r,tsym:n}});(pe.get(e)||[]).forEach((a=>a({name:e,price:r,tsym:n,error:!1,message:t})))}}})),be("BTC",(({price:e})=>me=e));const ke={class:"container"},Ce=n("hr",{class:"w-full border-t border-gray-400 my-8"},null,-1),Se=n("hr",{class:"w-full border-t border-gray-400 my-8"},null,-1),Ee={class:"mt-5 grid grid-cols-1 gap-5 sm:grid-cols-3 items-center"},Te=n("hr",{class:"w-full border-t border-gray-600 my-4"},null,-1);var Oe=e({async setup(e){let a,s;const i=ie();[a,s]=k((()=>i.loadCryptoObject())),a=await a,s();const{cryptoObject:d}=i,{graph:g}=function(e=80){const t=c([]);return u(t,(r=>{r.length>e&&(t.value=r.slice(-e))})),{graph:t}}(),{tickers:v,filter:h,paginatedTickers:b,page:w,hasNextPage:x,tickerExists:S,getTicker:E}=de(),T=c(null);var O;O={filter:h,page:w},Object.entries(O).forEach((([e,t])=>{u(t,(t=>{const r=new URLSearchParams(window.location.search);r.set(o(e),t.toString()),window.history.pushState(null,window.document.title,`${window.location.pathname}?${r.toString()}`)}),{immediate:!0})}));let{filter:_,page:N}=Object.fromEntries(new URLSearchParams(window.location.search).entries());function B({name:e,price:t,error:r,message:n}){var a;const s=E(e);if(s){if(r)return console.log({error:r,message:n}),void(s.error=n);s.price=t,(null==(a=T.value)?void 0:a.name)===e&&g.value.push(t)}}function P(e){if(!function(e){return Object.keys(d).includes(e)}(e)||E(e))return;const t={name:e,price:0};v.value=[...v.value,t],h.value="",be(t.name,B)}function L(e){var t;v.value=v.value.filter((t=>t.name!==e.name)),e.name===(null==(t=T.value)?void 0:t.name)&&(T.value=null),we(e.name,B)}function M(e){return Object.keys(d).filter((t=>t.includes(e)||d[t].FullName.toUpperCase().includes(e))).slice(0,4)}function A(e){T.value=e}function I(e){return h.value=e}return N&&(w.value=+N),_&&(h.value=_),u(T,(()=>{g.value=[]})),v.value.forEach((e=>{be(e.name,B)})),v.value.length>0&&A(v.value[0]),(e,a)=>{const s=K,i=X,c=te,u=le,d=C("crypto-graph");return t(),r("div",ke,[l(s,{"get-hints":M,"check-ticker":o(S),onAddTicker:P},null,8,["check-ticker"]),o(v).length?(t(),r(m,{key:0},[Ce,l(i,{onChange:I}),l(c,{class:"space-x-4 my-4","show-prev":o(w)>1,"show-next":o(x),onPrev:a[0]||(a[0]=e=>w.value-=1),onNext:a[1]||(a[1]=e=>w.value+=1)},null,8,["show-prev","show-next"]),Se,n("dl",Ee,[(t(!0),r(m,null,p(o(b),(e=>{var r;return t(),y(u,{key:e.name,ticker:e,selected:(null==(r=T.value)?void 0:r.name)===e.name,error:Boolean(e.error),onClick:t=>A(e),onDelete:L},null,8,["ticker","selected","error","onClick"])})),128))]),Te],64)):f("",!0),T.value?(t(),y(d,{key:1,graph:o(g),heading:`${T.value.name} - USD`,onCloseClick:a[2]||(a[2]=e=>T.value=null)},null,8,["graph","heading"])):f("",!0)])}}});const _e={key:0},Ne={class:"bg-gray-100"},Be={class:"container mx-auto flex flex-col items-center py-4"},Pe={class:"bg-gray-100"},Le={class:"container mx-auto flex flex-col items-center py-4"};var Me=e({setup(e){const a=c(null);return S((e=>(a.value=e,!0))),(e,s)=>{const o=P,i=I;return t(),r(m,null,[a.value?(t(),r("div",_e,[n("div",Ne,[n("div",Be,[l(o,{message:a.value.toString()},null,8,["message"])])])])):f("",!0),(t(),y(E,null,{default:g((()=>[n("div",Pe,[n("div",Le,[l(Oe)])])])),fallback:g((()=>[l(i)])),_:1}))],64)}}});if("undefined"!=typeof window){let e=function(){let e=document.body,t=document.getElementById("__svg__icons__dom__1631073352745__");t||(t=document.createElementNS("http://www.w3.org/2000/svg","svg"),t.style.position="absolute",t.style.width="0",t.style.height="0",t.id="__svg__icons__dom__1631073352745__"),t.innerHTML='<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#fff" id="icon-add"><path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" /></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.76 511.76" id="icon-close"><path d="M436.896 74.869c-99.84-99.819-262.208-99.819-362.048 0-99.797 99.819-99.797 262.229 0 362.048 49.92 49.899 115.477 74.837 181.035 74.837s131.093-24.939 181.013-74.837c99.819-99.818 99.819-262.229 0-362.048zm-75.435 256.448c8.341 8.341 8.341 21.824 0 30.165a21.275 21.275 0 0 1-15.083 6.251 21.277 21.277 0 0 1-15.083-6.251l-75.413-75.435-75.392 75.413a21.348 21.348 0 0 1-15.083 6.251 21.277 21.277 0 0 1-15.083-6.251c-8.341-8.341-8.341-21.845 0-30.165l75.392-75.413-75.413-75.413c-8.341-8.341-8.341-21.845 0-30.165 8.32-8.341 21.824-8.341 30.165 0l75.413 75.413 75.413-75.413c8.341-8.341 21.824-8.341 30.165 0 8.341 8.32 8.341 21.824 0 30.165l-75.413 75.413 75.415 75.435z" fill="#718096" data-original="#000000" /></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="#718096" aria-hidden="true" id="icon-delete"><path fill-rule="evenodd" d="M9 2a1 1 0 0 0-.894.553L7.382 4H4a1 1 0 0 0 0 2v10a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V6a1 1 0 1 0 0-2h-3.382l-.724-1.447A1 1 0 0 0 11 2H9zM7 8a1 1 0 0 1 2 0v6a1 1 0 1 1-2 0V8zm5-1a1 1 0 0 0-1 1v6a1 1 0 1 0 2 0V8a1 1 0 0 0-1-1z" clip-rule="evenodd" /></symbol><symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="icon-loader"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" /><path fill="currentColor" d="M4 12a8 8 0 0 1 8-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 0 1 4 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" /></symbol>',e.insertBefore(t,e.firstChild)};"interactive"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}T(Me).use(O()).mount("#app");
